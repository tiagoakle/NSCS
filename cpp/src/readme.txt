C version of the nscs_long_step algorithm
